-- Creates Tables for the database

CREATE TABLE IF NOT EXISTS brand (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(255) NOT NULL
);

CREATE TABLE IF NOT EXISTS unit (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    abbreviation VARCHAR(255) NOT NULL
);

CREATE TABLE IF NOT EXISTS product (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    brand_id BIGINT,
    quantity INTEGER NOT NULL,
    unit_id BIGINT,
    CONSTRAINT fk_brand
        FOREIGN KEY(brand_id) REFERENCES brand(id)
        ON DELETE SET NULL,
    CONSTRAINT fk_unit
        FOREIGN KEY(unit_id) REFERENCES unit(id)
        ON DELETE SET NULL
);

CREATE TABLE IF NOT EXISTS food (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(255) NOT NULL
);

CREATE TABLE IF NOT EXISTS recipe (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    servings INTEGER NOT NULL
);

CREATE TABLE IF NOT EXISTS recipe_product (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    recipe_id BIGINT,
    product_id BIGINT,
    CONSTRAINT fk_recipe
        FOREIGN KEY(recipe_id) REFERENCES recipe(id)
        ON DELETE CASCADE,
    CONSTRAINT fk_product
        FOREIGN KEY(product_id) REFERENCES product(id)
        ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS product_food (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    product_id BIGINT,
    food_id BIGINT,
    CONSTRAINT fk_product
        FOREIGN KEY(product_id) REFERENCES product(id)
        ON DELETE CASCADE,
    CONSTRAINT fk_food
        FOREIGN KEY(food_id) REFERENCES food(id)
        ON DELETE CASCADE
);
